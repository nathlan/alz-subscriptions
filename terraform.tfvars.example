# ==============================================================================
# Example Terraform Variables File
# ==============================================================================
# This file demonstrates the new structure for defining landing zones
# ==============================================================================

# ==============================================================================
# COMMON VARIABLES (Applied to All Landing Zones)
# ==============================================================================
# These variables are shared across all landing zones to ensure consistency

# REQUIRED: Azure billing scope for subscription creation
# Get this from your Enterprise Agreement enrollment account
common_subscription_billing_scope = "PLACEHOLDER_BILLING_SCOPE"

# REQUIRED: Hub virtual network resource ID for peering
# All spoke networks will peer to this hub
common_hub_network_resource_id = "PLACEHOLDER_HUB_VNET_ID"

# Management group for all subscriptions
common_subscription_management_group_id = "Corp"

# Default Azure region for all resources
common_location = "uksouth"

# GitHub organization for OIDC federated credentials
common_github_organization = "your-github-org"

# Tags applied to all subscriptions (merged with LZ-specific tags)
common_tags = {
  ManagedBy = "Terraform"
}

# ==============================================================================
# LANDING ZONES DEFINITION (Array of Objects)
# ==============================================================================
# Define multiple landing zones in this map
# Each key represents a unique landing zone name
# ==============================================================================

landing_zones = {
  # ===========================================================================
  # Example Landing Zone
  # ===========================================================================
  your-workload-name = {
    # Subscription Configuration
    subscription_display_name  = "your-workload-name (Production)"
    subscription_alias_name    = "sub-your-workload-prod"
    subscription_workload      = "Production" # or "DevTest"
    subscription_alias_enabled = true
    subscription_management_group_association_enabled = true

    subscription_tags = {
      Environment = "Production"
      Workload    = "your-workload-name"
      CostCenter  = "YOUR-COST-CENTER"
      Owner       = "TEAM-NAME"
      CreatedDate = "YYYY-MM-DD"
    }

    # Resource Groups
    resource_group_creation_enabled = true
    resource_groups = {
      rg_workload = {
        name     = "rg-your-workload-prod"
        location = "uksouth"
      }
      rg_identity = {
        name     = "rg-your-workload-identity"
        location = "uksouth"
      }
    }

    # Virtual Network with Hub Peering
    virtual_network_enabled = true
    virtual_networks = {
      spoke = {
        name               = "vnet-your-workload-prod-uksouth"
        resource_group_key = "rg_workload"
        address_space      = ["10.X.Y.0/24"] # Get unique CIDR from platform team
        location           = "uksouth"
        hub_peering_enabled = true
        # hub_network_resource_id uses common_hub_network_resource_id by default

        subnets = {
          default = {
            name             = "snet-default"
            address_prefixes = ["10.X.Y.0/26"]
          }
        }
      }
    }

    # OPTIONAL: User-Managed Identity with GitHub OIDC
    # Uncomment and configure if you need workload identity federation
    # umi_enabled = true
    # user_managed_identities = {
    #   deploy = {
    #     name               = "umi-your-workload-deploy"
    #     location           = "uksouth"
    #     resource_group_key = "rg_identity"
    #
    #     role_assignments = {
    #       subscription_contributor = {
    #         scope_resource_id              = "subscription"
    #         role_definition_id_or_name     = "Contributor"
    #       }
    #     }
    #
    #     federated_credentials_github = {
    #       main = {
    #         name       = "github-main"
    #         repository = "your-repo-name"
    #         entity     = "ref:refs/heads/main"
    #         # organization uses common_github_organization by default
    #       }
    #     }
    #   }
    # }

    # OPTIONAL: Monthly Budget with Notifications
    # Uncomment and configure to enable cost monitoring
    # budget_enabled = true
    # budgets = {
    #   monthly = {
    #     name              = "Monthly Budget"
    #     amount            = 500
    #     time_grain        = "Monthly"
    #     time_period_start = "YYYY-MM-01T00:00:00Z"
    #     time_period_end   = "YYYY-12-31T23:59:59Z"
    #
    #     notifications = {
    #       threshold_80 = {
    #         enabled        = true
    #         operator       = "GreaterThan"
    #         threshold      = 80
    #         contact_emails = ["your-email@example.com"]
    #         threshold_type = "Actual"
    #       }
    #     }
    #   }
    # }
  }

  # ===========================================================================
  # Add More Landing Zones Here
  # ===========================================================================
  # another-workload-name = {
  #   subscription_display_name = "another-workload (Production)"
  #   subscription_alias_name   = "sub-another-workload-prod"
  #   subscription_workload     = "Production"
  #   # ... configure as needed
  # }
}
